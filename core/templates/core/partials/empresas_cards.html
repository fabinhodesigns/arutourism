{% load static %}
{% for e in page_obj %}
  <div class="col">
    <article class="card empresa-card h-100" tabindex="0" role="link" data-href="{% url 'empresa_detalhe' e.id %}">
      {% if e.imagem and e.imagem.name %}
        <img class="card-img-top" src="{{ e.imagem.url }}" alt="Imagem de {{ e.nome }}">
      {% else %}
        <img class="card-img-top" src="{% static 'core/images/sem_imagem.png' %}" alt="Sem imagem para {{ e.nome }}">
      {% endif %}

      <div class="card-body d-flex flex-column">
        <span class="badge rounded-pill badge-cat mb-3">
          {{ e.categoria.nome_limpo|default:"Sem Categoria" }}
        </span>

        <h3 class="h5 card-title mb-2">{{ e.nome }}</h3>
        <p class="card-text text-muted mb-4">{{ e.descricao|default:"Sem descrição."|truncatechars:120 }}</p>

        <div class="mt-auto d-flex justify-content-between align-items-center gap-2">
          <a class="btn btn-primary btn-sm" href="{% url 'empresa_detalhe' e.id %}" aria-label="Ver detalhes de {{ e.nome }}">
            Ver Detalhes
          </a>
          {% if request.user.is_authenticated and e.user_id == request.user.id %}
            <a class="btn btn-outline-secondary btn-sm" href="{% url 'editar_empresa' e.id %}" aria-label="Editar {{ e.nome }}">
              <i class="bi bi-pencil-square" aria-hidden="true"></i> Editar
            </a>
          {% endif %}
        </div>
      </div>
    </article>
  </div>
{% endfor %}