{% extends 'base2.html' %}
{% load static %}

{% block title %}Gerador de QR Code Promocional{% endblock %}

{% block extra_css %}
  <link rel="stylesheet" href="{% static 'css/pages/gerador_qrcode.css' %}">
{% endblock %}

{% block content %}
<div class="hero-bar py-4 mt-5">
  <div class="container d-flex flex-wrap justify-content-between align-items-center gap-3">
    <nav aria-label="breadcrumb" class="m-0">
      <ol class="breadcrumb m-0" style="font-size: x-large;">
        <li class="breadcrumb-item"><a href="{% url 'perfil' %}">Perfil</a></li>
        <li class="breadcrumb-item active" aria-current="page">Gerador de QR Code</li>
      </ol>
    </nav>
  </div>
</div>

<main class="container page-shell py-4">
  <div class="row g-4 g-lg-5">
    <div class="col-lg-4">
      <div class="p-4 bg-light border rounded-3">
        <h4 class="fw-bold"><i class="bi bi-funnel-fill me-2"></i>Filtros</h4>
        <p class="text-muted small">Selecione os critérios para gerar o link e o QR Code dinamicamente.</p>
        <hr>
        <div class="mb-3">
          <label for="qr-tags" class="form-label fw-semibold">Tags (categorias)</label>
          <select id="qr-tags" class="form-select" multiple size="8">
            {% for tag in all_tags %}
              <option value="{{ tag.id }}">{{ tag.nome }}</option>
            {% endfor %}
          </select>
          <div class="form-text">Segure Ctrl (ou Cmd) para selecionar várias.</div>
        </div>
        <div class="mb-3">
          <label for="qr-cidade" class="form-label fw-semibold">Cidade</label>
          <select id="qr-cidade" class="form-select">
            <option value="" selected>Todas as cidades</option>
            {% for cidade in all_cidades %}
              <option value="{{ cidade }}">{{ cidade }}</option>
            {% endfor %}
          </select>
        </div>
      </div>
    </div>

    <div class="col-lg-8">
      <div id="qr-result-area" class="p-4 border rounded-3 text-center position-relative">
        <div id="qr-placeholder" class="qr-placeholder-content">
          <i class="bi bi-qr-code-scan display-1 text-muted"></i>
          <p class="mt-3 text-muted">Seu QR Code aparecerá aqui assim que você selecionar um filtro.</p>
        </div>

        <div id="qr-generated-content" class="qr-generated-content">
          <div id="qr-code-container" class="mb-4 d-inline-block p-3 border rounded-3 bg-white shadow-sm">
            </div>
          <label for="qr-link-input" class="form-label text-start w-100">Link Gerado:</label>
          <div class="input-group mb-3">
            <input type="text" id="qr-link-input" class="form-control" readonly>
            <button class="btn btn-outline-secondary" type="button" id="qr-copy-btn" title="Copiar link">
              <i class="bi bi-clipboard"></i>
            </button>
          </div>
          <div class="d-flex justify-content-center flex-wrap gap-2">
            <a id="qr-download-btn" class="btn btn-primary" download="qrcode-arutourism.png">
              <i class="bi bi-download me-1"></i> Baixar QR Code (PNG)
            </a>
            <a id="qr-whatsapp-btn" class="btn btn-success" href="#" target="_blank">
              <i class="bi bi-whatsapp me-1"></i> Compartilhar no WhatsApp
            </a>
          </div>
        </div>

      </div>
    </div>
  </div>
</main>
{% endblock %}

{% block extra_js %}
  <script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>
  <script src="{% static 'js/site/gerador_qrcode.js' %}"></script>
{% endblock %}